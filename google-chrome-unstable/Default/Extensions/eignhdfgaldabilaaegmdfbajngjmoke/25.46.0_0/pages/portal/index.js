"use strict";!function(){var D=window,M=document,I="undefined"!=typeof chrome&&chrome||{},T="undefined"!=typeof KeyboardEvent&&"key"in KeyboardEvent.prototype&&!/MSIE |Edge\/|Trident.*rv:11\./.test(navigator.userAgent)&&void 0===String.quote,A=T?" ":32,K=T?"Enter":13,O=T?"ArrowUp":38,P=T?"ArrowDown":40;cjce.registerTemplate("bm-p-portal",function(e,i){e.classList.add("bm-p-portal");var c,o=[],s="",r="search",d=!1;function l(e,t,a){e=(e=e).shortcutId&&cjgFrontend.urls.getShortcutUrl(e.shortcutId,i.account)||e.url;i.openTab(e,t,a)}i.darkMode&&e.style.setProperty("--background-color","#2d2d2d");var p={},m={};function u(t,e){var a=i.servicesDatabase[t],n=a.iconName||"placeholder",c=(i.darkMode&&"googleg"===n&&(n="search"),cjce.createElement("cjmd-item",{icon:{serviceName:n},label:a.label}));return c.classList.add("bm-p-portal-pageitem"),c.dataset.id=t,c.tabIndex=0,c.style.color=(n=a.color)?!0===n?i.darkMode?"#669df6":"#1a73e8":n:i.darkMode?"rgba(255, 255, 255, 0.8)":"#212121",e?(c.draggable=!0,(n=cjce.createElement("cjmd-icon",{name:"__mdi:drag_indicator",size:20})).classList.add("bm-p-portal-pageitem__dragicon"),c.appendChild(n),(e=cjce.createElement("ccbm-iconbutton",{iconName:"__mdi:delete",label:cjBasics.lang.i18n("cj_i18n_01164","Remove from menu"),onClick:function(e){i.userServices.remove(t),c.remove(),s=s.replace("_"+t+"_","_"),e.stopPropagation()}})).classList.add("bm-p-portal-pageitem__remove"),c.appendChild(e)):(a.shortcutId||a.url)&&((n=cjce.createElement("ccbm-iconbutton",{iconName:"__mdi:open_in_new",label:cjBasics.lang.i18n("cj_i18n_00084","Open service in new tab"),onClick:function(e){var t=cjBasics.hasMetaKey(e);l(a,e.shiftKey,t),e.stopPropagation()}})).classList.add("bm-p-portal-pageitem__open-in-new"),c.appendChild(n)),c}function t(e){n(e===r?i.userServices.getLastUsedNonToolsPage():e)}function g(e){var t=c.scrollTop,e=e.offsetTop,a=e-60;(a<t||t<(a=e-c.offsetHeight-4))&&(c.scrollTop=a)}function v(){var a=!i.account.pageId&&d,n=M.createDocumentFragment(),e=((o||[]).forEach(function(e){var t;i.servicesDatabase[e]&&(t=u(e,a),m[e]=t,n.appendChild(t))}),m[r]);e&&e.classList.add("cjmd-item--selected"),c.textContent="",c.appendChild(n),e&&g(e)}function a(e){var t=o.indexOf(r);n(o[t+(e?-1:1)]||(e?o[o.length-1]:o[0]))}function f(){"removedialog"===r&&n("customize")}function b(e){e.preventDefault()}function _(e){e.preventDefault();var t=e.dataTransfer.getData("serviceId"),a=e.target,n=a,e=(n=24<e.offsetY&&a.nextSibling?a.nextSibling:n).dataset.id,n=o.indexOf(e);a===c||-1===n?i.userServices.add(t):(-1!==(e=o.indexOf(t))&&o.splice(e,1),o.splice(n,0,t),i.userServices.set(o)),f()}function n(e){var t;"customize"===e&&0===o.length&&(t={welcome:!0}),i.pageManager.navigate(e,t)}function h(e){n("removedialog"),e.dataTransfer.setData("serviceId",e.target.dataset.id)}i.darkMode&&e.classList.add("cjmd--dark"),E=cjce.createElement("cjmd-appbar"),(x=cjce.createElement("ccbm-iconbutton",{iconName:"__mdi:apps",label:cjBasics.lang.i18n("cj_i18n_00216","Apps"),onClick:function(){t("applauncher")}})).classList.add("bm-p-portal-pageicon"),p.applauncher=x,E.appendChild(x),(x=cjce.createElement("ccbm-iconbutton",{iconName:"__mdi:settings",label:cjBasics.lang.i18n("cj_i18n_00298","Settings"),onClick:function(){t("extensionsettings")}})).classList.add("bm-p-portal-pageicon"),p.extensionsettings=x,E.appendChild(x),i.account.validSession?((L=cjce.createElement("ccbm-iconbutton",{iconName:"__mdi:notifications",label:cjBasics.lang.i18n("cj_i18n_00296","Notifications"),onClick:function(){t("notifications")}})).classList.add("bm-p-portal-pageicon"),p.notifications=L,E.insertBefore(L,x),L=i.account.displayName,i.account.pageId&&(L+="\n"+cjBasics.lang.i18n("cj_i18n_00363","Brand account")),i.account.displayEmail&&(L+="\n"+i.account.displayEmail),j=cjce.createElement("ccbm-iconbutton",{label:L,icon:{size:32,avatar:!0,url:cjgFrontend.urls.getAvatar(i.account.photoUrl,32)},onClick:function(){t("accountchooser")}}),(p.accountchooser=j).classList.add("bm-p-portal-pageicon"),E.appendChild(j),cjgApis.info.getIsOne(i.account).then(function(e){e&&j.classList.add("bm-p-portal-accountbutton--one")})):((x=cjce.createElement("ccbm-button",{label:cjBasics.lang.i18n("cj_i18n_01544","Sign in"),fill:!0,color:!0,onClick:function(){cjgApis.account.signin(i.account)}})).classList.add("bm-p-portal-signin"),E.appendChild(x));var j,E,L=E;function C(e){var t,a,n;e!==r&&((t=p[a=r])?t.setAttribute("aria-selected","false"):(t=m[a])&&t.classList.remove("cjmd-item--selected"),(a="customize"===(r=e)||"removedialog"===e)!==d?(d=a,v(),c.classList.toggle("bm-p-portal-pagelist--customize",d),n=d,setTimeout(function(){k.classList.toggle("bm-p-portal-customize--finish",n),S.hidden=n,B.hidden=!n,y||(N.textContent=n?z:w),n?(D.addEventListener("dragend",f),c.addEventListener("dragover",b),c.addEventListener("drop",_),c.addEventListener("dragstart",h)):(D.removeEventListener("dragend",f),c.removeEventListener("dragover",b),c.removeEventListener("drop",_),c.removeEventListener("dragstart",h))})):(t=p[e])?t.setAttribute("aria-selected","true"):(a=m[e])&&(a.classList.add("cjmd-item--selected"),g(a)))}e.appendChild(L),(c=cjce.createElement("cjmd-container",{scrollable:!0,shadow:"transparentOnScroll"})).setAttribute("role","navigation"),c.addEventListener("click",function(e){var t,a=e.target.dataset.id;a&&(t=e.shiftKey,e=cjBasics.hasMetaKey(e),t||e?l(i.servicesDatabase[a],t,e):n(a))}),c.addEventListener("pointerdown",function(e){e=e.target.dataset.id;e&&i.loadPage(e)}),c.addEventListener("auxclick",function(e){var t;1===e.button&&(t=e.target.dataset.id)&&(l(i.servicesDatabase[t],e.shiftKey,!0),e.preventDefault())}),c.addEventListener("keydown",function(e){t=e;var t=T&&t.key||t.which||t.keyCode,a=e.shiftKey,n=cjBasics.hasMetaKey(e);if(a||n)return t!==K&&(c=e.target.dataset.id)?void l(i.servicesDatabase[c],a,n):void 0;var c=M.activeElement;if(t===O)(c.previousSibling||c.parentNode.lastChild).focus();else if(t===P)(c.nextSibling||c.parentNode.firstChild).focus();else{if(t!==K&&t!==A)return;c.click()}e.preventDefault()}),i.userServices.onChange(function(e){var t="_"+e.join("_")+"_";s!==t&&(o=e,s=t,v())}),i.pageManager.onChange(function(e){C(e)}),e.appendChild(c);var k=M.createElement("div"),y=(k.className="bm-p-portal-page bm-p-portal-customize",Boolean(i.account.pageId)),S=(k.dataset.id=y?"accountchooser":"customize",cjce.createElement("cjmd-icon",{name:y?"__mdi:account_circle":"__mdi:edit",color:i.darkMode?null:"#5f6368"})),B=(S.classList.add("bm-p-portal-customize__icon"),k.appendChild(S),cjce.createElement("cjmd-icon",{name:"__mdi:done"})),N=(B.hidden=!0,B.classList.add("bm-p-portal-customize__icon"),k.appendChild(B),M.createElement("div")),w=cjBasics.lang.i18n("cj_i18n_01713","Customize"),x=cjBasics.lang.i18n("cj_i18n_01543","Switch account"),z=cjBasics.lang.i18n("cj_i18n_01715","Finish");N.textContent=y?x:w,N.className="bm-p-portal-customize__label",k.appendChild(N),k.addEventListener("click",function(){var e=y?"accountchooser":d?i.userServices.getLastUsedNonToolsPage():"customize";n(e)}),e.appendChild(k);try{I.commands.onCommand.addListener(function(e){"portal-next-page"===e?a(!1):"portal-previous-page"===e&&a(!0)})}catch(e){}})}();