"use strict";cjce.registerTemplate("bm-p-messages",function(e,c){var i="https://messages.google.com",t=i+"/web/u/"+c.account.authuser+"/",a=cjBasics.generateUniqueId(),n=c.darkMode?"1":"0",s={bm_iid:a,bm_cid:"messages",hl:cjBasics.lang.getCurrent(),bm_cst:"1",bm_udm:c.darkMode?"1":"0",dark_theme:n,dl_dark_theme:n},o="authentication",l=!1,r={conversations:{iconName:"__mdi:message",label:cjBasics.lang.i18n("cj_i18n_01487","Conversations"),newTabUrl:"conversations"},archived:{iconName:"__mdi:archive",label:cjBasics.lang.i18n("cj_i18n_01740","Archived"),newTabUrl:"conversations"},calls:{iconName:"__mdi:call",label:cjBasics.lang.i18n("cj_i18n_01170","Calls"),newTabUrl:"calls"},voicemail:{iconName:"__mdi:voicemail",label:cjBasics.lang.i18n("cj_i18n_01129","Voicemail"),newTabUrl:"voicemail"},settings:{iconName:"__mdi:settings",label:cjBasics.lang.i18n("cj_i18n_00298","Settings"),newTabUrl:"settings"},relatedHeader:{color:!0,header:!0,label:cjBasics.lang.i18n("cj_i18n_01539","Related apps")},chat:{iconName:"__mdi:chat_bubble_outline",label:cjBasics.lang.i18n("cj_i18n_06694","Google Chat"),shortcutId:"559",external:!c.servicesDatabase.chat},meet:{iconName:"__mdi:meet",label:cjBasics.lang.i18n("cj_i18n_00809","Meet"),shortcutId:"545",external:!c.servicesDatabase.meet}},m={authentication:cjBasics.lang.i18n("cj_i18n_01745","Connect phone"),newConversation:cjBasics.lang.i18n("cj_i18n_01741","New conversation"),newGroupConversation:cjBasics.lang.i18n("cj_i18n_01742","New group conversation"),conversation:cjBasics.lang.i18n("cj_i18n_01743","Conversation")},d=cjce.createElement("bm-ogb",{drawer:!0,withShadow:!0,serviceIcon:"messages",serviceLabel:cjBasics.lang.i18n("cj_i18n_01084","Messages"),pageLabel:cjBasics.lang.i18n("cj_i18n_07237","Authentication"),bmApis:c,onBack:function(){v.cjceSendFrameCommand({method:"bmCstNavigateBack"},i)},onNewTab:function(e,a,n){v.cjceGetCleanUrl(i).then(function(e){c.openTab(e||t)})}});function _(e){v.cjceSendFrameCommand({method:"bmCstClickDomElement",value:e},i)}function j(){_(".notifications-button")}e.appendChild(d);var g=cjce.createElement("ccbm-iconbutton",{label:cjBasics.lang.i18n("cj_i18n_06600","Unmute notifications"),iconName:"__mdi:notifications_off",onClick:j}),b=(g.hidden=!0,d.cjceAppendChild(g),cjce.createElement("ccbm-iconbutton",{label:cjBasics.lang.i18n("cj_i18n_06599","Mute notifications"),iconName:"__mdi:notifications",onClick:j})),h=(b.hidden=!0,d.cjceAppendChild(b),cjce.createElement("ccbm-iconbutton",{iconName:cjBasics.navigator.isSafari?"__mdi:more_horiz":"__mdi:more_vert",onClick:function(){_(".conversation-menu-icon")}}));function u(e){e="conversation"===e;b.hidden=!e||!l,g.hidden=!e||l,h.hidden=!e}h.hidden=!0,d.querySelector(".cjmd-appbar").appendChild(h),cjBasics.webRequest.handleIframeHeaders([i+"/*bm_iid="+a+"*"],{handleFirefoxInject:!0,handleSwCache:!0}),cjBasics.webRequest.catchAndStop(["https://accounts.google.com/AccountChooser*"+t+"postSignIn"],function(){v.src=cjBasics.urlParams.attach(t+"postSignIn",s)});var v=cjce.createElement("bm-iframe",{src:cjBasics.urlParams.attach(t+"authentication",s),onBmMessage:function(e,a){var n;"messagesUpdateView"===e?(u(o=a),n=(n=r[o])&&n.label||m[o],d.cjceSetPageLabel(n),p.cjceSelectedId=o):"messagesBackState"===e?d.cjceSetBackState(a):"messagesMutedState"===e?(l=a,b.hidden=!l,g.hidden=l):"messagesPageTitle"===e&&a&&(m.conversation=a,"conversation"===o)&&d.cjceSetPageLabel(a)}}),n=(e.appendChild(v),d.cjceDrawerEl),p=cjce.createElement("bm-navlist",{isSelector:!0,selectedId:o,items:r,onChange:function(e){"chat"===e||"meet"===e?(c.pageManager.navigate(e),p.cjceSelectedId=o):(v.cjceSendFrameCommand({method:"messagesActivateMenuItem",value:e},i),"archived"===e&&(p.cjceSelectedId=e="conversations"),u(o=e))},onNewTab:function(e,a){a=a.newTabUrl?t+a.newTabUrl:cjgFrontend.urls.getShortcutUrl(a.shortcutId,c.account);c.openTab(a)}});n.appendChild(p)});