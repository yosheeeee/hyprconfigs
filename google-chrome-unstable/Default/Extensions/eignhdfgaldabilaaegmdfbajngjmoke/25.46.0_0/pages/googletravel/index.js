"use strict";function _slicedToArray(e,t){return _arrayWithHoles(e)||_iterableToArrayLimit(e,t)||_unsupportedIterableToArray(e,t)||_nonIterableRest()}function _nonIterableRest(){throw new TypeError("Invalid attempt to destructure non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}function _unsupportedIterableToArray(e,t){var a;if(e)return"string"==typeof e?_arrayLikeToArray(e,t):"Map"===(a="Object"===(a={}.toString.call(e).slice(8,-1))&&e.constructor?e.constructor.name:a)||"Set"===a?Array.from(e):"Arguments"===a||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(a)?_arrayLikeToArray(e,t):void 0}function _arrayLikeToArray(e,t){(null==t||t>e.length)&&(t=e.length);for(var a=0,n=Array(t);a<t;a++)n[a]=e[a];return n}function _iterableToArrayLimit(e,t){var a=null==e?null:"undefined"!=typeof Symbol&&e[Symbol.iterator]||e["@@iterator"];if(null!=a){var n,i,r,c,s=[],l=!0,o=!1;try{if(r=(a=a.call(e)).next,0===t){if(Object(a)!==a)return;l=!1}else for(;!(l=(n=r.call(a)).done)&&(s.push(n.value),s.length!==t);l=!0);}catch(e){o=!0,i=e}finally{try{if(!l&&null!=a.return&&(c=a.return(),Object(c)!==c))return}finally{if(o)throw i}}return s}}function _arrayWithHoles(e){if(Array.isArray(e))return e}cjce.registerTemplate("bm-p-googletravel",function(e,r){var c,n,i,s,l,o,d,t,a,h="trips",u=!cjBasics.webRequest.getWrifSupported(),m=cjBasics.generateUniqueId(),b="https://www.google.com",g="https://consent.google.com",_=!0,p={bm_cid:"googletravel",bm_cst:"1",bm_iid:m,bm_udm:r.darkMode?"1":null,bm_wiz:"1",hl:cjBasics.lang.getCurrent()},j=r.account.authuser,f=("0"!==j&&(p.authuser=j),"subscriptions/list/hotels"),v="flights/saves",y="transit/tickets",B="settings",T=["flights","explore","transit/",f,v,y],w=[v,f,y,B],k={trips:{iconName:"__mdi:cjg_trips",label:cjBasics.lang.i18n("cj_i18n_00307","Trips"),newTabUrl:!0},explore:{iconName:"__mdi:cjg_travel_explore",label:cjBasics.lang.i18n("cj_i18n_00061","Explore"),newTabUrl:!0},"things-to-do":{iconName:"__mdi:camera_alt",label:cjBasics.lang.i18n("cj_i18n_06628","Things to do"),newTabUrl:!0},flights:{iconName:"__mdi:travel",label:cjBasics.lang.i18n("cj_i18n_00414","Flights"),newTabUrl:!0},hotels:{iconName:"__mdi:hotel",label:cjBasics.lang.i18n("cj_i18n_01030","Hotels"),newTabUrl:!0,external:!1},holidayrentals:{iconName:"__mdi:house",label:cjBasics.lang.i18n("cj_i18n_06630","Holiday rentals"),newTabUrl:!0,external:!1},packages:{iconName:"__mdi:beach_access",label:cjBasics.lang.i18n("cj_i18n_01751","Packages"),newTabUrl:!0},"transit/":{iconName:"__mdi:directions_transit",label:cjBasics.lang.i18n("cj_i18n_06629","Trains"),newTabUrl:!0,divider:!0},settings:{iconName:"__mdi:settings",label:cjBasics.lang.i18n("cj_i18n_00298","Settings"),newTabUrl:!0},relatedHeader:{color:!0,header:!0,label:cjBasics.lang.i18n("cj_i18n_06647","Quick access")},"flights/saves":{iconName:"__mdi:timeline",label:cjBasics.lang.i18n("cj_i18n_01125","Tracked flight prices"),newTabUrl:!0},"subscriptions/list/hotels":{iconName:"__mdi:timeline",label:cjBasics.lang.i18n("cj_i18n_06627","Tracked hotel prices"),newTabUrl:!0},"transit/tickets":{iconName:"__mdi:local_activity",label:cjBasics.lang.i18n("cj_i18n_06626","Your train tickets"),newTabUrl:!0},save:{label:cjBasics.lang.i18n("cj_i18n_06669","Favourite itineraries"),iconName:"__mdi:bookmarks",external:!u&&!r.servicesDatabase.save}};function C(e){var t=e;"trips"===e?t="":"holidayrentals"===e&&(t="hotels");t=cjBasics.urlParams.attach("/travel/"+t,p);return"holidayrentals"===e?t+"&hrf=YAE":t}function x(e){e=b+"/search?q="+encodeURIComponent(e);"0"!==r.account.authuser&&(e+="&authuser="+r.account.authuser),r.openTab(e)}function A(e){var t=b,a={},e=("save"===e?t+="/saved":"holidayrentals"===e?(t+="/travel/hotels",a.hrf="YAE"):t+="/travel/"+e,"0"!==j&&(a.authuser=j),cjBasics.urlParams.attach(t,a));r.openTab(e)}function N(e,t){var a="hotels"===e||"holidayrentals"===e,t=((!(a&&("hotels"===h||"holidayrentals"===h))||a&&t)&&(o.cjceSelectedId=e,c.cjceSetPageLabel(k[e].label)),n.hidden="flights"!==e,i.hidden="flights"!==e,s.hidden=!a,_||(l.hidden="transit/"!==e),-1!==w.indexOf(e));c.cjceSetBackState(t),h=e}function S(e){N((e=e).startsWith("/flights/saves")||e.startsWith("/travel/flights/saves")?v:e.startsWith("/flights/explore")||e.startsWith("/travel/explore")||e.startsWith("/travel/flights/explore")?"explore":e.startsWith("/travel/subscriptions/list/hotels")?f:-1!==e.indexOf("/travel/transit")?-1!==e.indexOf("/travel/transit/tickets")?y:"transit/":e.startsWith("/flights")||e.startsWith("/travel/flights")?"flights":e.startsWith("/travel/settings")?B:e.startsWith("/travel/guide")||e.startsWith("/travel/things-to-do")?"things-to-do":e.startsWith("/travel/search")||e.startsWith("/travel/hotels")?"hotels":"trips")}function U(){return cjce.createElement("bm-navlist",{selectedId:u?null:h,items:k,onChange:I,onClick:u?A:I,onNewTab:A})}function I(e,t){var a;"save"===e?(o.cjceSelectedId=h,r.pageManager.navigate("save",{listId:"dt_fav_itineraries"})):(e!==h&&"hotels"!==e&&"holidayrentals"!==e&&c.cjceSetLoading(!0),a=C(e),t||h!==(t=e)&&(-1!==T.indexOf(t)||-1!==T.indexOf(h))?d.src=b+a:d.cjceSendFrameCommand({method:"bmCstUpdateState",value:a},b),N(e,!0))}_&&(delete k.packages,delete k["transit/tickets"],delete k["transit/"],delete k["things-to-do"]),t={onSubmit:x,submitInNewTab:!0},c=cjce.createElement("bm-ogb",{loading:!u,serviceIcon:"travel",serviceLabel:cjBasics.lang.i18n("cj_i18n_00308","Travel"),pageLabel:u?cjBasics.lang.i18n("cj_i18n_00291","Home"):cjBasics.lang.i18n("cj_i18n_00307","Trips"),drawer:!u,onBack:function(){d.cjceSendFrameCommand({method:"bmCstNavigateBack"},b)},searchbox:u?t:null,bmApis:r,onNewTab:function(){k[h];u?A(h):d.cjceGetCleanUrl(b).then(function(e){e?r.openTab(e):A(h)})}}),e.appendChild(c),(i=cjce.createElement("ccbm-iconbutton",{iconName:k.explore.iconName,label:k.explore.label,onClick:function(){I("explore")}})).hidden=!0,c.cjceAppendChild(i),(n=cjce.createElement("ccbm-iconbutton",{iconName:k[v].iconName,label:k[v].label,onClick:function(){I(v)}})).hidden=!0,c.cjceAppendChild(n),(s=cjce.createElement("ccbm-iconbutton",{iconName:k[f].iconName,label:k[f].label,onClick:function(){I(f)}})).hidden=!0,c.cjceAppendChild(s),_||((l=cjce.createElement("ccbm-iconbutton",{iconName:k[y].iconName,label:k[y].label,onClick:function(){I(y)}})).hidden=!0,c.cjceAppendChild(l)),o=U(),u?((t=cjce.createElement("cjmd-container",{shadow:"thinOnScroll"})).appendChild(o),e.appendChild(t),t=c.cjceSearchboxEl,r.setOnPageDisplayHandler(t.select)):(c.cjceDrawerEl.appendChild(o),a=cjBasics.webRequest.addListener("onBeforeRequest",function(){delete k["transit/tickets"],delete k["transit/"],k.holidayrentals.divider=!0;var e=U();return o.parentNode.replaceChild(e,o),o=e,a.removeListener(),{cancel:!0}},{types:["xmlhttprequest"],urls:[b+"/u/?/travel/transit/geofencing*",b+"/travel/transit/geofencing*"]},["blocking"]),cjBasics.ajax(b+"/travel/transit/trip/a?authuser="+j).catch(function(){}),cjBasics.webRequest.handleIframeHeaders([b+"/*bm_iid="+m+"*","https://search.google.com/*bm_iid="+m+"*",g+"/*bm_iid="+m+"*",g+"/*bm_iid%3D"+m+"*"],{disableOgs:b,handleFirefoxInject:!0,handleSecVariables:!0,handleSwCache:!0,useMobileUserAgent:!0}),cjBasics.webRequest.addListener("onBeforeRequest",function(e){if(e.initiator===b&&(e.url.startsWith(b)&&-1===e.url.indexOf("bm_cid")))return{redirectUrl:cjBasics.urlParams.attach(e.url,p)}},{types:["sub_frame"],urls:[b+"/travel*",b+"/flights*"]},["blocking"]),cjBasics.webRequest.catchAndStop(["https://accounts.google.com/AccountChooser*"+encodeURIComponent("bm_iid="+m)+"*"],function(){r.pageManager.navigate("accountchooser"),I(h,!0)}),cjBasics.webRequest.catchAndStop([b+"/maps*",b+"/search*"],function(e){r.openTab(e),I(h,!0)}),cjBasics.webRequest.addListener("onBeforeRequest",function(e){if(-1!==e.url.indexOf("/m=kg1Y1d"))return{cancel:!0}},{types:["script"],urls:["https://www.gstatic.com/_/mss/boq-travel/_/js/k=boq-travel.TravelFrontendUi_mobile_ms*"]},["blocking"]),d=cjce.createElement("bm-iframe",{onBmMessage:function(e,t){var a,n,i;"bmCstOpenUrl"===e?(i=(n=_slicedToArray(t,3))[0],a=n[1],n=n[2],i=cjBasics.cleanBmUrl(i),r.openTab(i,a,n)):"googletravelUpdatePath"===e&&(S(t),c.cjceSetLoading(!1))},src:b+C(h),solid:!0,shadow:!0,onLoad:function(){c.cjceSetLoading(!1)}}),e.appendChild(d),r.setOnPageDisplayHandler(function(e){e&&e.navId&&I(e.navId)}))});