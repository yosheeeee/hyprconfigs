"use strict";!function(){function p(e,n){var t=!e.dueDate,a=!n.dueDate;if(t&&a)return e.title>n.title?1:-1;if(t)return 1;if(a)return-1;t=!0===e.dueDate.unspecifiedFutureTime,a=!0===n.dueDate.unspecifiedFutureTime;if(t&&a)return e.title>n.title?1:-1;if(t)return 1;if(a)return-1;var t=parseInt(e.dueDate.absoluteTimeMs,10),a=parseInt(n.dueDate.absoluteTimeMs,10),i=e.dueDate.allDay,c=n.dueDate.allDay;if(e.dueDate.day===n.dueDate.day){if(i&&c||t===a)return e.title>n.title?1:-1;if(i)return-1;if(c)return 1}return a<t?-1:1}cjce.registerTemplate("bm-p-reminderswithgapi__reminderslist",function(n,e){var t,s=e.bmApis,a=e.onLoadChange,e="https://reminders-pa.googleapis.com",r="https://keep.google.com"+s.wizPath+"/",i=["https://www.googleapis.com/auth/reminders"],c=window.atob("QUl6YVN5QldkTkdkdEZBVk1ucktVaTA0YnRxcVhvVzNsNHNvMFVr");function l(){var e=cjgFrontend.urls.getShortcutUrl("540",s.account);s.openTab(e)}function o(){var e=cjce.createElement("bm-fulldialog",{bmApis:s,onNewTab:l,lockup:{label:cjBasics.lang.i18n("cj_i18n_00081","Reminders")},iconName:"reminders",message:cjBasics.lang.i18n("cj_i18n_00212","To use Reminders, you need to give access to load your Google Reminders data"),actionLabel:cjBasics.lang.i18n("cj_i18n_01916","Continue with Google"),actionG:!0,action:function(){cjgApis.auth.requestPermissions(s.account,i)}});n.appendChild(e)}function d(e){var n,t,a,i,c=(n=(n=(n=(t=e).extensions)&&n.keepExtension)&&(n.serverNoteId||n.clientNoteId))?{url:r+"#NOTE/"+n,noteId:n}:(t=(n=t.externalApplicationLink)&&"keepReminder"===n.application&&n.id)?{url:r+"?reminder="+t,reminderId:t}:void 0;return c?{label:cjBasics.lang.i18n("cj_i18n_00215","View note"),onClick:function(e){e&&(cjBasics.hasMetaKey(e)||e.shiftKey)?s.openTab(c.url):s.pageManager.navigate("keep",{noteData:c})}}:(n=e.assistance&&e.assistance.taskAssistance&&e.assistance.taskAssistance.assistance&&e.assistance.taskAssistance.assistance[0])?n.callAction?(t=n.callAction.phoneNumber)&&(a=t[0]&&t[0].phoneNumber)?{label:cjBasics.lang.i18n("cj_i18n_00213","Call"),onClick:function(){var e=cjBasics.urlParams.attach("https://hangouts.google.com/",{authuser:s.account.authuser,action:"chat",pn:a});s.openTab(e)}}:null:n.emailAction?(i=n.emailAction.emailAddress&&n.emailAction.emailAddress[0]&&n.emailAction.emailAddress[0].emailAddress,{label:cjBasics.lang.i18n("cj_i18n_00214","Email"),onClick:function(){s.openTab("mailto:"+i)}}):null:null}function u(e){var n,t=cjce.createElement("cjmd-card",{withPadding:!0}),a=cjce.createElement("cjmd-title",{label:e.title||cjBasics.lang.i18n("cj_i18n_01737","(No title)")}),i=(t.appendChild(a),e.dueDate&&((a=document.createElement("div")).className="cjmd-secondarytext",a.textContent=(n=e.dueDate).unspecifiedFutureTime?"Someday":((i=new Date).setFullYear(n.year),i.setMonth(n.month-1),i.setDate(n.day),n.time&&(i.setHours(n.time.hour),i.setMinutes(n.time.minute),i.setSeconds(n.time.second)),cjBasics.datetime.printDateString(i.getTime(),{time:!n.allDay,weekday:!0})),t.appendChild(a)),d(e));return i&&((n=cjce.createElement("ccbm-button",{color:!0,outline:!0,label:i.label,onClick:i.onClick})).style.marginTop="8px",t.appendChild(n)),t}function m(e){n.textContent="",Array.isArray(e)&&0<e.length?e.forEach(function(e){e=u(e);n.appendChild(e)}):(e=cjce.createElement("cjmd-emptystate",{label:cjBasics.lang.i18n("cj_i18n_01499","No reminders found"),iconName:"__mdi:reminder"}),n.appendChild(e))}cjce.applyTemplate(n,"cjmd-container",{scrollable:!0,shadow:"transparentOnScroll"}),cjgApis.cache.getItem(s.account,"bm_cache_v33__reminderswithgapi__reminders").then(function(e){Array.isArray(e)&&(t=JSON.stringify(e),m(e))}),e=cjBasics.urlParams.attach(e+"/v1internalOP/reminders/list",{fields:"task",prettyPrint:"false"}),cjgApis.request(e,{method:"POST",fetchAs:"json",headers:{"Content-Type":"application/json"},body:JSON.stringify({includeDeleted:!1,includeArchived:!1})},{pa:!0,key:c,account:s.account,requiredScopes:i}).then(function(e){e=e.task.sort(p);return cjgApis.cache.setItem(s.account,"bm_cache_v33__reminderswithgapi__reminders",e),e},o).then(function(e){return Array.isArray(e)?e:[]},function(){return[]}).then(function(e){t&&JSON.stringify(e)===t||(m(e),a&&a(!1))})}),cjce.registerTemplate("bm-p-reminderswithgapi",function(e,t){var n=cjce.createElement("bm-ogb",{loading:!0,drawer:!0,serviceIcon:"reminders",serviceLabel:cjBasics.lang.i18n("cj_i18n_00081","Reminders"),pageLabel:cjBasics.lang.i18n("cj_i18n_00291","Home"),bmApis:t,onNewTab:function(){var e=cjgFrontend.urls.getShortcutUrl("540",t.account);t.openTab(e)}}),a=(e.appendChild(n),{reminders:{iconName:"__mdi:home",label:cjBasics.lang.i18n("cj_i18n_00291","Home"),shortcutId:"561"},relatedHeader:{color:!0,header:!0,label:cjBasics.lang.i18n("cj_i18n_01539","Related apps")},calendar:{iconName:"__mdi:date_range",label:cjBasics.lang.i18n("cj_i18n_00302","Calendar"),shortcutId:"27"},keep:{iconName:"__mdi:drive_keep",label:cjBasics.lang.i18n("cj_i18n_00422","Keep"),shortcutId:"97"},tasks:{iconName:"__mdi:task_alt",label:cjBasics.lang.i18n("cj_i18n_00439","Tasks"),shortcutId:"140"}}),a=cjce.createElement("bm-navlist",{selectedId:"reminders",items:a,onClick:function(e){t.pageManager.navigate(e)},onNewTab:function(e,n){n=n.newTabUrl||cjgFrontend.urls.getShortcutUrl(n.shortcutId,t.account);t.openTab(n)}}),a=(n.cjceDrawerEl.appendChild(a),cjce.createElement("bm-p-reminderswithgapi__reminderslist",{bmApis:t,onLoadChange:function(e){n.cjceSetLoading(e)}}));e.appendChild(a)})}();