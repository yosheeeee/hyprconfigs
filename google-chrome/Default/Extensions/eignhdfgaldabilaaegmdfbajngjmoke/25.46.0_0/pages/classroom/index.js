"use strict";!function(){var ie=document,se="https://classroom.google.com",le=["https://www.googleapis.com/auth/classroom.courses.readonly"],oe=cjBasics.lang.i18n("cj_i18n_00305","Classroom"),re=cjBasics.lang.i18n("cj_i18n_01255","Classes"),de=cjBasics.lang.i18n("cj_i18n_06654","Add {LINK_URL} to a class");function he(e){if(-1===e.indexOf("hrq.crs"))throw new Error("Not a course request");var s,l,o,r,d,e='[["wrb.fr","gXtzob","[\\"hrq.crs'+e.split("hrq.crs")[1].split('"generic"]]')[0]+'"generic"]]',e=JSON.parse(e)[0][2],e=JSON.parse(e)[2];return 0===e.length?null:(s={},l=[],o=[],r=[],d=[],e.forEach(function(a){var e,c,n=Date.now().toString();try{n=a[0][0]}catch(e){"string"==typeof a[28]&&(n=a[28].replace("c:",""))}n.length<11?n+="ZZ":n.length<12&&(n+="Z"),n=window.btoa(n);try{e=a[9][2].replace("https://gstatic.com/","https://ssl.gstatic.com/")}catch(e){}try{c=a[9][1]}catch(e){}var t=2===a[20],i=4===a[43];s[n]={id:n,enrolled:i,label:a[5],section:a[8]||null,themeBackground:e,themeColor:c},(t?o:i?r:d).push(n),l.push(n)}),{courseDatabase:s,allIds:l,archivedIds:o,enrolledIds:r,teachingIds:d})}cjce.registerTemplate("bm-p-classroom",function(a,n){var l,o,r,u,t,x,i,s,c,d,h,m,p,b,g,_,j,f=n.wizPath+"/",e=!n.account.validSession,v=!e&&cjBasics.webRequest.getWrifSupported()&&!cjBasics.navigator.isFirefox,C=!e&&v,P=v&&!0,w=v&&!1,v=!w&&!e,q=!e&&!0,M=!1,z=!1,B=(a.classList.add("bm-p-classroom"),C&&n.darkMode&&a.classList.remove("cjmd--dark"),cjBasics.generateUniqueId()),F=C,R={bm_cid:"classroomwithwebapp",bm_wiz:"1",bm_cst:"1",bm_iid:B,hl:cjBasics.lang.getCurrent()},E=!1,S="h",I="h",W=new Promise(function(e){x=e}),T=cjBasics.lang.i18n("cj_i18n_06653","current url"),k={h:{iconName:"__mdi:home",label:re,newTabUrl:!0},calendar:{iconName:"__mdi:calendar_today",label:cjBasics.lang.i18n("cj_i18n_01256","Calendar"),newTabUrl:"calendar/this-week/course/all",divider:!0},teachingSubheader:{header:!0,label:cjBasics.lang.i18n("cj_i18n_06577","Teaching")},ta:{iconName:"__mdi:cjg_classroom_to_review",label:cjBasics.lang.i18n("cj_i18n_06622","To review"),newTabUrl:"ta/not-reviewed/all"},enrolledSubheader:{header:!0,label:cjBasics.lang.i18n("cj_i18n_06578","Enrolled")},a:{iconName:"__mdi:cjg_classroom_to_do",label:cjBasics.lang.i18n("cj_i18n_06233","To do"),newTabUrl:"a/not-turned-in/all"},archived:{iconName:"__mdi:archive",label:cjBasics.lang.i18n("cj_i18n_01257","Archived classes"),newTabUrl:"h/archived"},s:{iconName:"__mdi:settings",label:cjBasics.lang.i18n("cj_i18n_00298","Settings"),newTabUrl:!0}};function N(e){n.openTab(se+f+e)}function H(){E||(E=!0,setTimeout(function(){_.remove()},500),i.cjceSetLoading(!1))}function y(e,a){var c,n;function t(){var e;n||(n=!0,e=cjBasics.urlParams.attach(f+c,R),g.cjceSendFrameCommand({method:"bmCstUpdateState",value:e},se),E)||H()}!a&&g&&P?(c=e,n=!1,W.then(t),setTimeout(t,5e3)):N(e)}function V(e){var a;e&&!F&&"not_authorized"===e.cjg_error&&(F=!0,j.remove(),a=cjce.createElement("bm-fulldialog",{inline:!0,lockup:{label:cjBasics.lang.i18n("cj_i18n_00305","Classroom")},iconName:"classroom",message:cjBasics.lang.i18n("cj_i18n_00237","To use Classroom, you need to give access to display your Classroom classes"),actionLabel:cjBasics.lang.i18n("cj_i18n_01916","Continue with Google"),actionG:!0,action:function(){cjgApis.auth.requestPermissions(n.account,e.cjg_missing_scopes)}}),_.appendChild(a),cjgApis.cache.remove(n.account,"bm_cache_v33__classroomwithgapi__classlist"))}function K(e){var n,a,c,t,i=["h","calendar","teachingSubheader","ta","enrolledSubheader","a","archived","s"],e=(k.ta.divider=!e,k.a.divider=!e,e&&(n=e.courseDatabase,a=e.archivedIds,c=e.enrolledIds,t=e.teachingIds,e.allIds.forEach(function(e){var a=n[e],c=a.themeColor;k["c/"+e]={color:c,label:a.label,newTabUrl:!0,colorIcon:!0,icon:{theme:"solid",name:"__mdi:class"}}}),i=["h","calendar"],0<t.length&&(i.push("teachingSubheader","ta"),t.forEach(function(e){i.push("c/"+e)}),e=t[t.length-1],k["c/"+e].divider=!0),0<c.length&&(i.push("enrolledSubheader","a"),c.forEach(function(e){i.push("c/"+e)}),t=c[c.length-1],k["c/"+t].divider=!0),0<a.length&&i.push("archived"),i.push("s")),i.map(function(e){var a=k[e];return a.id=e,C||"h"===e||(a.external=!0),a}));return cjce.createElement("bm-navlist",{selectedId:S,items:e,isSelector:!0,onChange:function(e,a){s.cjceSelectedId=S,y("string"==typeof a.newTabUrl&&a.newTabUrl||e)},onNewTab:function(e,a){N("string"==typeof a.newTabUrl&&a.newTabUrl||e)}})}function G(e){var a;c&&(e=K(e),a=c&&c.contains(ie.activeElement)&&c.classList.contains("cjmd-sheet--open"),cjce.replaceChild(c,e,s),a&&c.cjceToggleState(!0),s=e)}function J(e){e="https://drive.google.com/drive"+n.wizPath+"/folders/"+e;n.openTab(e)}function Z(e,a){n.servicesDatabase.drive?n.pageManager.navigate("drive",{folderParameters:{id:e,name:a}}):J(e)}function L(){!function(){var e,c,n,a,t,i,s;if(o)return u=o,(t=l||r)&&(e=(a=o).allIds,c=a.courseDatabase,n=t.courseDatabase,e.forEach(function(e){var a=n[e];a&&(e=c[e],!l&&e.teacherFolder||(e.teacherFolder=a.teacherFolder))}));l?(u=l,r&&(t=(a=l).allIds,i=a.courseDatabase,s=r.courseDatabase,t.forEach(function(e){var a=s[e];a&&((e=i[e]).themeColor=a.themeColor,e.themeBackground=a.themeBackground)}),["allIds","archivedIds","enrolledIds","teachingIds"].forEach(function(e){var a=l[e],c=r[e],a=a.sort(function(e,a){return c.indexOf(e)-c.indexOf(a)});l[e]=a}))):u=r}();var d,c,h,m,e=u,a=JSON.stringify(e);a!==t&&(t=a,E||(_.hidden=!e),d=ie.createDocumentFragment(),z&&((c=cjce.createElement("cjmd-appbar")).classList.add("bm-p-classroom-quicknav"),["a","ta","calendar"].forEach(function(e){var a=k[e],e=cjce.createElement("ccbm-iconbutton",{iconName:a.iconName,label:a.label,onClick:function(){y(a.newTabUrl)},onMetaClick:function(){N(a.newTabUrl)}});c.appendChild(e)}),a=c,d.appendChild(a)),e&&(h=e.courseDatabase,a=e.allIds,m=e.archivedIds,a.forEach(function(e){var a,c,n,t,i,s,l,o,r;Array.isArray(m)&&"includes"in m&&m.includes(e)||(e=h[e],c=(e=e).teacherFolder,n=e.enrolled,t=e.id,i=e.label,s=e.section,l=e.themeBackground,e=e.themeColor,o="c/"+t,(r=ie.createElement("div")).tabIndex=0,r.dataset.id=o,r.className="bm-p-classroom-card",(o=ie.createElement("header")).className="bm-p-classroom-card__top",e&&(o.style.backgroundColor=e),l&&(o.style.backgroundImage='url("'+l+'")'),r.appendChild(o),(e=ie.createElement("h3")).className="bm-p-classroom-card__title",e.textContent=i,o.appendChild(e),s&&((l=ie.createElement("div")).textContent=s,e.appendChild(l)),C&&((i=ie.createElement("p")).textContent=cjBasics.lang.i18n("cj_i18n_00325","Loading…"),i.className="bm-p-classroom-card__loading",r.appendChild(i)),(o=cjce.createElement("cjmd-appbar",{transparent:!0})).classList.add("bm-p-classroom-card__appbar"),r.appendChild(o),n||(a="c/".concat(t,"/gb/sort-name/all-classwork"),s=cjce.createElement("ccbm-iconbutton",{iconName:"__mdi:trending_up",label:cjBasics.lang.i18n("cj_i18n_07232","Open student record cards"),onClick:function(){y(a)},onMetaClick:function(){N(a)}}),o.appendChild(s)),c&&(e=cjce.createElement("ccbm-iconbutton",{iconName:"__mdi:folder",label:cjBasics.lang.i18n("cj_i18n_07231","Open folder"),onClick:function(){Z(c.id,c.title)},onMetaClick:function(){J(c.id)}}),o.appendChild(e)),l=r,d.appendChild(l))})),j.textContent="",j.appendChild(d),G(e),cjgApis.cache.setItem(n.account,"bm_cache_v33__classroom__courses",e))}function X(){cjBasics.webRequest.addListener("onBeforeRequest",function(e){var a;"POST"===e.method&&"sub_frame"===e.frameType&&e.initiator.startsWith(se)&&(x(),-1!==(a=e.requestBody.formData)["f.req"][0].indexOf('"[[1000,'))&&(e=e.url,cjBasics.ajax(e,{method:"POST",headers:{"Content-Type":"application/x-www-form-urlencoded;charset=UTF-8"},body:cjBasics.urlParams.create(a)}).then(he).then(function(e){o=e,L()},function(){}))},{urls:[se+"/*batchexecute*"],types:["xmlhttprequest"]},["requestBody"])}var Y={add:"M20 13h-7v7h-2v-7H4v-2h7V4h2v7h7v2z",filter:"M10 18h4v-2h-4v2zM3 6v2h18V6H3zm3 7h12v-2H6v2z",menu:"M3 18h18v-2H3v2zm0-5h18v-2H3v2zm0-7v2h18V6H3z",settings:"M13.85 22.25h-3.7c-.74 0-1.36-.54-1.45-1.27l-.27-1.89c-.27-.14-.53-.29-.79-.46l-1.8.72c-.7.26-1.47-.03-1.81-.65L2.2 15.53c-.35-.66-.2-1.44.36-1.88l1.53-1.19c-.01-.15-.02-.3-.02-.46 0-.15.01-.31.02-.46l-1.52-1.19c-.59-.45-.74-1.26-.37-1.88l1.85-3.19c.34-.62 1.11-.9 1.79-.63l1.81.73c.26-.17.52-.32.78-.46l.27-1.91c.09-.7.71-1.25 1.44-1.25h3.7c.74 0 1.36.54 1.45 1.27l.27 1.89c.27.14.53.29.79.46l1.8-.72c.71-.26 1.48.03 1.82.65l1.84 3.18c.36.66.2 1.44-.36 1.88l-1.52 1.19c.01.15.02.3.02.46s-.01.31-.02.46l1.52 1.19c.56.45.72 1.23.37 1.86l-1.86 3.22c-.34.62-1.11.9-1.8.63l-1.8-.72c-.26.17-.52.32-.78.46l-.27 1.91c-.1.68-.72 1.22-1.46 1.22zm-3.23-2h2.76l.37-2.55.53-.22c.44-.18.88-.44 1.34-.78l.45-.34 2.38.96 1.38-2.4-2.03-1.58.07-.56c.03-.26.06-.51.06-.78s-.03-.53-.06-.78l-.07-.56 2.03-1.58-1.39-2.4-2.39.96-.45-.35c-.42-.32-.87-.58-1.33-.77l-.52-.22-.37-2.55h-2.76l-.37 2.55-.53.21c-.44.19-.88.44-1.34.79l-.45.33-2.38-.95-1.39 2.39 2.03 1.58-.07.56a7 7 0 0 0-.06.79c0 .26.02.53.06.78l.07.56-2.03 1.58 1.38 2.4 2.39-.96.45.35c.43.33.86.58 1.33.77l.53.22.38 2.55z"};function U(e){e=Y[e];g.cjceSendFrameCommand({method:"bmCstClickDomElement",value:'body > div > nav[role="navigation"] div[soy-skip] button span:has(svg>path[d*="'+e+'"])'},se)}function Q(){U("menu")}function $(){g?g.cjceGetCleanUrl(se).then(function(e){e?n.openTab(e):N("h")}):N("h")}var A,D,O=se+f+S,ee=cjBasics.urlParams.attach(O,R);function ae(e){var a=S.replace("c",e);return"w"===e?a+"/t/all":"r"===e?a+"/sort-name":a}function ce(){var e=(s.cjceSelectedId=S)in k,e=(i.cjceSetBackState(!e),d.hidden="h"!==S,m.hidden="calendar"!==S,S.startsWith("c/")&&-1===I.indexOf("/a/")),a=e||I.startsWith("ta/")||I.startsWith("a/"),a=(g.classList.toggle("cjmd-shadow--thin",!a),M&&e&&(b||(a={c:cjBasics.lang.i18n("cj_i18n_06655","Stream"),w:cjBasics.lang.i18n("cj_i18n_06656","Classwork"),r:cjBasics.lang.i18n("cj_i18n_00295","People")},b=cjce.createElement("cjmd-appbar",{secondary:!0}),p=cjce.createElement("ccbm-tabs",{items:a,onChange:function(e){y(ae(e))},onMetaClick:function(e){N(ae(e))},selectedId:"c"}),b.appendChild(p),i.appendChild(b)),p.cjceSelectedId=I[0]),h.hidden=!e,b&&(b.hidden=!e),k[S]),e=a&&a.color;i.style.setProperty("--ccc-accent-color",e||"")}function ne(){return cjce.createElement("bm-iframe",{src:ee,shadow:!0,onBmMessage:function(e,a){var c;"classroomwithwebappOpenDriveFolder"===e?Z(a):"classroomwithwebappViewData"===e?(I=a.pathname,f=a.mainServicePath,S="h/archived"===(c=I)?"archived":!c||"h"===c||c.startsWith("h/")?"h":"calendar"===c||c.startsWith("calendar/")?"calendar":"ta"===c||c.startsWith("ta/")?"ta":"a"===c||c.startsWith("a/")?"a":-1===c.indexOf("/a/")&&(c.startsWith("r/")||c.startsWith("w/")||c.startsWith("c/"))?"c/"+c.split("/")[1].split("/")[0]:c,w||ce(),(c=(c=k[S])&&c.label)||(c=a.title.split(" -")[0].split(" –")[0])&&c!==oe||(c=re),I.startsWith("share")&&(c=de.replace("{LINK_URL}",T)),i.cjceSetPageLabel(c)):"classroomwithwebappLoadingState"===e&&(i.cjceSetLoading(a),a||E||setTimeout(H,50))}})}function te(){a.textContent="";var e=cjce.createElement("bm-fulldialog",{bmApis:n,onNewTab:function(){N("h")},lockup:{label:oe},iconName:"classroom",message:cjBasics.lang.i18n("cj_i18n_06625","You can't use {PRODUCT_NAME} with this account.").replace("{PRODUCT_NAME}",oe),actionLabel:cjBasics.lang.i18n("cj_i18n_01543","Switch account"),action:function(){n.pageManager.navigate("accountchooser")}});a.appendChild(e)}cjBasics.webRequest.handleIframeHeaders([se+"/*bm_iid="+B+"*"],{disableOgs:se,handleFirefoxInject:!0,handleSecVariables:!0,handleSwCache:!0}),i=cjce.createElement("bm-ogb",{loading:!e,drawer:v,navigator:w&&{onClick:Q},serviceIcon:"classroom",serviceLabel:oe,pageLabel:e?cjBasics.lang.i18n("cj_i18n_00291","Home"):re,bmApis:n,onBack:function(){g.cjceSendFrameCommand({method:"bmCstNavigateBack"},se)},onNewTab:$}),n.darkMode&&C&&i.classList.add("cjmd--dark"),a.appendChild(i),P&&(d=cjce.createElement("ccbm-iconbutton",{iconName:"__mdi:add",label:cjBasics.lang.i18n("cj_i18n_06579","Create or join a class"),onClick:function(){E||y("h"),U("add")}}),i.cjceAppendChild(d),(h=cjce.createElement("ccbm-iconbutton",{iconName:"__mdi:settings",label:cjBasics.lang.i18n("cj_i18n_06580","Class settings"),onClick:function(){U("settings")}})).hidden=!0,i.cjceAppendChild(h),(m=cjce.createElement("ccbm-iconbutton",{iconName:"__mdi:today",label:cjBasics.lang.i18n("cj_i18n_01253","Today"),onClick:function(){y("calendar/this-week/course/all")}})).hidden=!0,i.cjceAppendChild(m),(O=cjce.createElement("ccbm-iconbutton",{iconName:"__mdi:tune",onClick:function(){U("filter")}})).hidden=!0,i.cjceAppendChild(O)),A=cjce.createElement("ccbm-iconbutton",{iconName:"__mdi:link",label:de.replace("{LINK_URL}",T),onClick:function(){y("share?url="+encodeURIComponent(T)),setTimeout(function(){A.remove()},200)}}),cjBasics.navigator.getActionableUrl().then(function(e){e?(i.cjceAppendChild(A),T=e.url,A.title=de.replace("{LINK_URL}",T)):A.remove()}),c=i.cjceDrawerEl,G(),cjBasics.webRequest.catchAndStop([se+f+"ineligible*"],te,!0),e?(D=cjce.createElement("cjmd-container",{shadow:"thinOnScroll",scrollable:!0}),s=K(),D.appendChild(s),a.appendChild(D)):(C&&(g=ne(),a.appendChild(g)),(_=ie.createElement("div")).classList.add("bm-p-classroom-dummy"),j=cjce.createElement("cjmd-container",{solid:C,scrollable:!0,shadow:"thinOnScroll"}),_.appendChild(j),cjce.applyTemplate(j,"basic-anyclickhandler",{onClick:function(e){var a=ie.activeElement,a=a&&a.dataset.id;a&&y(a,cjBasics.hasMetaKey(e))}}),a.appendChild(_),cjgApis.cache.getItem(n.account,"bm_cache_v33__classroom__courses").then(function(e){e&&(r=e,L())}),q&&(D=n.account,B=cjBasics.urlParams.attach("https://classroom.googleapis.com/v1/courses",{courseStates:["ACTIVE","PROVISIONED","ARCHIVED"],fields:"courses(alternateLink,courseState,creationTime,enrollmentCode,name,section,teacherFolder)",prettyPrint:"false",pageSize:"100"}),cjgApis.request(B,{fetchAs:"json"},{account:D,requiredScopes:le}).then(function(e){var t,i,s,l,o,e=e.courses;return 0===e.length?null:(t={},i=[],s=[],l=[],o=[],e.sort(function(e,a){return e.creationTime>a.creationTime?-1:1}).forEach(function(e){var a=e.alternateLink.split("c/")[1],c=!e.enrollmentCode,n="ARCHIVED"===e.courseState?s:c?l:o,n=(n.push(a),i.push(a),e.name);t[a]={teacherFolder:e.teacherFolder,enrolled:c,id:a,label:n,section:e.section||null,themeColor:c?"#34a853":null}}),{courseDatabase:t,allIds:i,archivedIds:s,enrolledIds:l,teachingIds:o})},V).then(function(e){l=e,L(),C||i.cjceSetLoading(!1)})),C&&X())})}();